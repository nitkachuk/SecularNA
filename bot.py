import asyncio
from g4f.client import Client

from replacements import replacements, doReplacements  # type: ignore
from state import attempts, has_glyphs, escape_markdown_v2, escape_system_text, \
    readTheBook, telegramPost, aiRequest, channelBook, channelBill, \
    createMessage   # type: ignore
from roulette import getRandomTheme   # type: ignore


async def main():
    # —É–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫–∞ (–¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ—Å—Ç–≤)
    book = doReplacements( readTheBook() )
    message_to_send = escape_markdown_v2( book )

    # –ø–æ—Å—Ç–∏–Ω–≥ –≤ –∫–∞–Ω–∞–ª "–°–≤–µ—Ç—Å–∫–∏–π –µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫"
    await telegramPost( channelBook, message_to_send, '–ü–æ—Å—Ç –≤ –∫–∞–Ω–∞–ª –µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫–∞ üìò')
    return    

    
    # –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ –ø–æ –∫–Ω–∏–≥–µ üó£Ô∏è
    role_system = """ –í—ã—Å–∫–∞–∂–∏—Å—å –ø–æ-—Ä—É—Å—Å–∫–∏, –ø–æ —Ç–µ–∫—Å—Ç—É, –≤ –¥—É—Ö–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏. 
                      1-2 –Ω–µ–±–æ–ª—å—à–∏—Ö –∞–±–∑–∞—Ü–∞. –î–æ–±–∞–≤—å 3-5 —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç. –ü–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–í—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ –ø–æ –∫–Ω–∏–≥–µ üó£Ô∏è'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    await telegramPost( channelBill, ai_response, title )

    
    # —Ç–µ–º—ã –¥–ª—è —Å–æ–±—Ä–∞–Ω–∏–π üìå
    role_system = """ –ü—Ä–∏–¥—É–º–∞–π 2 —Ç–µ–º—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Å–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–∫–ª–∏–∫–∞—é—Ç—Å—è —Å —Ç–µ–∫—Å—Ç–æ–º, 
                      –Ω–æ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç –µ–≥–æ. –†–∞–∑–¥–µ–ª–∏ —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –∏ 
                      –æ–±–æ–∑–Ω–∞—á—å –∫–∞–∂–¥—ã–π –æ–¥–Ω–∏–º —ç–º–æ–¥–∑–∏. –ü–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–¢–µ–º—ã –¥–ª—è —Å–æ–±—Ä–∞–Ω–∏–π üìå'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    await telegramPost( channelBill, ai_response, title )

    
    # —Ä—É–ª–µ—Ç–∫–∞ üçí
    themeText = getRandomTheme()
    role_system = """ –°–æ—á–∏–Ω–∏ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ –æ–ø–∏—à—É—Ç —Ç–µ–∫—Å—Ç. –°–¥–µ–ª–∞–π –∫—Ä–∞—Å–∏–≤—ã–µ 
                      –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –∏ –¥–æ–±–∞–≤—å 2 —ç–º–æ–¥–∑–∏. –ü–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–†—É–ª–µ—Ç–∫–∞! –°–ª—É—á–∞–π–Ω–∞—è —Ç–µ–º–∞ üçí'

    ai_response = aiRequest( role_system, themeText )
    ai_response = createMessage( ai_response, title, f"##{themeText}" )
    
    await telegramPost(  channelBill, ai_response, title )
    

    # —à–∞–≥–∏ –∏ —Ç—Ä–∞–¥–∏—Ü–∏–∏ üßòüèº
    role_system = """ –ù–∞–π–¥–∏ –æ–¥–∏–Ω –∏–∑ 12 —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—Å—Ç—É. –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏ –≤ —á–µ–º 
                      —à–∞–≥ –ø–µ—Ä–µ–∫–ª–∏–∫–∞–µ—Ç—Å—è —Å —Ç–µ–∫—Å—Ç–æ–º. –ù–∞–π–¥–∏ –æ–¥–Ω—É –∏–∑ 12 —Ç—Ä–∞–¥–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 
                      —Ç–µ–∫—Å—Ç—É. –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏ –≤ —á–µ–º —à–∞–≥ –ø–µ—Ä–µ–∫–ª–∏–∫–∞–µ—Ç—Å—è —Å —Ç–µ–∫—Å—Ç–æ–º. –†–∞–∑–¥–µ–ª–∏ —ç—Ç–∏ —à–∞–≥ –∏ 
                      —Ç—Ä–∞–¥–∏—Ü–∏—é –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –∏ –æ–±–æ–∑–Ω–∞—á—å –∫–∞–∂–¥—ã–π –æ–¥–Ω–∏–º —ç–º–æ–¥–∑–∏. –ü–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–®–∞–≥–∏ –∏ —Ç—Ä–∞–¥–∏—Ü–∏–∏ üßòüèº'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    
    await telegramPost( channelBill, ai_response, title )
    

    # –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã üå±
    role_system = """ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã: —á–µ—Å—Ç–Ω–æ—Å—Ç—å, –Ω–µ–ø—Ä–µ–¥—É–±–µ–∂–¥–µ–Ω–Ω–æ—Å—Ç—å, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å, —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, 
                      –ø—Ä–∏–Ω—è—Ç–∏–µ, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –¥–æ–≤–µ—Ä–∏–µ, –∫–∞–ø–∏—Ç—É–ª—è—Ü–∏—è, –Ω–∞–¥–µ–∂–¥–∞, –≤–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω—è—Ç–æ–º—É —Ä–µ—à–µ–Ω–∏—é, 
                      –º—É–∂–µ—Å—Ç–≤–æ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —É–ø–æ—Ä—Å—Ç–≤–æ, –ø—Ä–∏–Ω—è—Ç–∏–µ —Å–µ–±—è, –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ, —Ç–µ—Ä–ø–µ–Ω–∏–µ, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, 
                      –ª—é–±–æ–≤—å, –ø—Ä–æ—â–µ–Ω–∏–µ, —Å–∞–º–æ–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, —á–∏—Å—Ç–æ—Å–µ—Ä–¥–µ—á–∏–µ, –±–µ—Å–∫–æ—Ä—ã—Å—Ç–∏–µ, –Ω–µ–ø–æ–∫–æ–ª–µ–±–∏–º–æ—Å—Ç—å. 
                      –ü—Ä–∏–≤–µ–¥–∏ 2 –ø—Ä–∏–Ω—Ü–∏–ø–∞ –ø–æ —Ç–µ–∫—Å—Ç—É, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ —Å–µ–≥–æ–¥–Ω—è –Ω–∞–¥–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –∏ –Ω–∞–ø–∏—à–∏ –ø–æ 
                      1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –∫–∞–∂–¥—ã–π. –†–∞–∑–¥–µ–ª–∏ —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –∏ 
                      –æ–±–æ–∑–Ω–∞—á—å –∫–∞–∂–¥—ã–π –æ–¥–Ω–∏–º —ç–º–æ–¥–∑–∏. –ø–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã üå±'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    await telegramPost( channelBill, ai_response, title )


    # —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ üé≠
    role_system = """ –ü—Ä–∏–≤–µ–¥–∏ 1 –Ω–µ–≥–∞—Ç–∏–≤–Ω—É—é —á–µ—Ä—Ç—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –ø–æ —Ç–µ–∫—Å—Ç—É, –Ω–∞–¥ –∫–æ—Ç–æ—Ä–æ–π —Å–µ–≥–æ–¥–Ω—è –Ω–∞–¥–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –∏ –Ω–∞–ø–∏—à–∏ 
                      1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —ç—Ç–æ–π –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–π —á–µ—Ä—Ç—ã. –ü—Ä–∏–≤–µ–¥–∏ 1 —á–µ—Ä—Ç—É –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è 
                      –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–π —á–µ—Ä—Ç—ã –∏ –Ω–∞–ø–∏—à–∏ 1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —ç—Ç–æ–π –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–π 
                      —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞. –†–∞–∑–¥–µ–ª–∏ —ç—Ç–∏ —á–µ—Ä—Ç—ã –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –∏ –æ–±–æ–∑–Ω–∞—á—å –∫–∞–∂–¥—ã–π –æ–¥–Ω–∏–º 
                      —ç–º–æ–¥–∑–∏. –ø–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–ß–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ üé≠'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    await telegramPost( channelBill, ai_response, title )
    

    # –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å üìù
    role_system = """ –ü—Ä–∏–¥—É–º–∞–π 3 –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å, –∫–æ—Ç–æ—Ä—ã–µ —è –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å, 
                      —á—Ç–æ–±—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—É. –†–∞–∑–¥–µ–ª–∏ —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –º–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –∏ 
                      –æ–±–æ–∑–Ω–∞—á—å –∫–∞–∂–¥—ã–π –æ–¥–Ω–∏–º —ç–º–æ–¥–∑–∏. –ø–æ-—Ä—É—Å—Å–∫–∏. """
    title = '–ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å üìù'

    ai_response = aiRequest( role_system, book )
    ai_response = createMessage( ai_response, title )
    await telegramPost( channelBill, ai_response, title )

    
    # –∫–æ–Ω–µ—á–Ω—ã–π –≤—ã–≤–æ–¥
    print( "\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫:", attempts, "–∏–∑ 20", flush=True )
    print( "–í—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! ‚úÖ ‚úÖ ‚úÖ ", flush=True )

asyncio.run(main())
